#!/usr/bin/env babel-node

import program from "commander";
import TeamworkChat from "..";
import { INSTALLATION, USERNAME, PASSWORD } from "../test";

program
    .option("-t, --to <handle>", "The handle to send the message to.")
    .option("-m, --message <message>", "The message content.")
    .parse(process.argv);

TeamworkChat.fromCredentials(INSTALLATION, USERNAME, PASSWORD).then(chat => {
    return chat.getPersonByHandle(program.to).then(person => {
        return person.sendMessage(program.message);
    }).then(message => {
        console.log("Message sent:", message);
    }).finally(() => {
        chat.close();
    }).catch(err => {
        console.error("Message not sent.", err);
    });
});